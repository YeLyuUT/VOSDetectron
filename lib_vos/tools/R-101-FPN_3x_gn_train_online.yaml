MODEL:
  TYPE: generalized_rcnn
  CONV_BODY: FPN.fpn_ResNet101_conv5_body
  FASTER_RCNN: True
  MASK_ON: True
  ADD_UNKNOWN_CLASS: False
  IDENTITY_TRAINING: True
  CLS_AGNOSTIC_BBOX_REG: False
  LOAD_FLOW_FILE: False
NUM_GPUS: 1
SOLVER:
  WEIGHT_DECAY: 0.0001
  LR_POLICY: steps_with_decay
  BASE_LR: 0.00002
  GAMMA: 0.1
  WARM_UP_ITERS: 50
  MAX_ITER: 2000
#  STEPS: [0, 80]
FPN:
  FPN_ON: True
  MULTILEVEL_ROIS: True
  MULTILEVEL_RPN: True
  USE_GN: True  # Note: use GN on the FPN-specific layers
  RPN_ANCHOR_START_SIZE: 32 # TODO can change to bigger value(such as 48 or 64). Default: 32 64 128 256 512
  ROI_CANONICAL_SCALE: 448 # TODO can change to bigger value
  COARSEST_STRIDE: 64
RESNETS:
  IMAGENET_PRETRAINED_WEIGHTS: '../../data/pretrained_model/R-101-GN.pkl'
  STRIDE_1X1: False  # default True for MSRA; False for C2 or Torch models
  TRANS_FUNC: bottleneck_gn_transformation  # Note: this is a GN bottleneck transform
  STEM_FUNC: basic_gn_stem  # Note: this is a GN stem
  SHORTCUT_FUNC: basic_gn_shortcut  # Note: this is a GN shortcut
  USE_GN: True
FAST_RCNN:
  ROI_BOX_HEAD: fast_rcnn_heads.roi_Xconv1fc_gn_head  # Note: this is a Conv GN head
  ROI_XFORM_METHOD: RoIAlign
  ROI_XFORM_RESOLUTION: 7
  ROI_XFORM_SAMPLING_RATIO: 2
MRCNN:
  ROI_MASK_HEAD: mask_rcnn_heads.mask_rcnn_fcn_head_v1up4convs_gn  # Note: this is a GN mask head
  RESOLUTION: 56  # (output mask resolution) default 14
  ROI_XFORM_METHOD: RoIAlign
  ROI_XFORM_RESOLUTION: 28  # default 7
  ROI_XFORM_SAMPLING_RATIO: 2  # default 0
  DILATION: 2  # default 2
  CONV_INIT: MSRAFill  # default GaussianFill
  CLS_SPECIFIC_MASK: True
CONVGRU:
  DYNAMIC_MODEL: True
RPN:
  ASPECT_RATIOS: (0.2, 0.5, 1, 2, 5)
TRAIN:
  SCALES: (640, 608, 576, 544, 480, 416, 384, 352, 320)
  MAX_SIZE: 1333
  IMS_PER_BATCH: 1
  BATCH_SIZE_PER_IM: 128
  RPN_PRE_NMS_TOP_N: 512  # Per FPN level
  RPN_POST_NMS_TOP_N: 256
  RPN_FG_FRACTION: 0.8 # Higher FG fraction for higher recall.
  USE_FLIPPED: False
  FREEZE_CONV_BODY: False
  FREEZE_CONV_GRU: True
  FREEZE_MASK: False
  FREEZE_RPN: False
  FREEZE_BOX_HEAD: False
  SNAPSHOT_ITERS: 1500
  LOSS_WEIGHT_CLS: 10.
  LOSS_WEIGHT_BBOX: 1.
  LOSS_WEIGHT_MASK: 5.
  SC_CLS_LOSS_TH: 0.05
  SC_BBOX_LOSS_TH: 0.1
  SC_MASK_LOSS_TH: 0.1
TEST:
  SCALE: 480
  MAX_SIZE: 1333
  NMS: 0.5
  RPN_PRE_NMS_TOP_N: 256  # Per FPN level
  RPN_POST_NMS_TOP_N: 256
  NUM_DET_PER_CLASS_PRE: 30
  NUM_DET_PER_CLASS_POST: 1 
  NMS_WITH_MASK_IOU: 0.9
  NMS_CROSS_CLASS: 0.
  BBOX_VOTE:
    ENABLED: False
    VOTE_TH: 0.5
    SCORING_METHOD: IOU_AVG
